













Восстановление фазы когерентной несущей частоты цифровым фазовым фильтром


Введение
сигнал цифровой фильтр
В работе рассматривается метод восстановления фазы когерентной несущей частоты принимаемого цифровым приемником сигнала с помощью блока цифрового восстановления фазы когерентной несущей (ЦВФКН). Использование цифрового фазового фильтра позволяет обойтись без применения традиционной фазовой подстройки частоты (ФАПЧ). В данной работе также показана методика вывода передаточной функции данного цифрового фильтра и рассмотрен вопрос его устойчивости к самовозбуждению. В работе также приведена функциональная схема этого фильтра.
В настоящее время в радиосвязи, радиолокации, радиоастрономии, радионавигации, радиоизмерения и других направлениях радиоэлектроники и автоматики необходимо точно восстановить фазу когерентной несущей частоты принимаемого сигнала с целью его последующей обработки и детектирования. Синхронное детектирование [1, 2, 3] позволяет обеспечить более качественное детектирование принимаемого сигнала и обеспечить выигрыш в отношении сигнал-шум величиной в 3 дБ, что особенно важно, если на вход приемника поступают слабые или зашумленные сигналы. 
В работе [1, стр.43; 2, стр.14; 3] описан метод построения устройства восстановления когерентной несущей принимаемого сигнала для последующего построения синхронных детекторов. Однако, в этих работах приведены результаты для аналоговой обработки сигналов. Построение цифровых схем на основе теории дискретных систем напрямую по этим результатам не всегда возможно.


1. Определение комплексной передаточной функции (КПФ) цифрового фазового фильтра (ЦФФ)

Целью данной статьи является определение комплексной передаточной функции (КПФ) цифрового фазового фильтра (ЦФФ) и построение функциональной схемы устройства цифрового восстановления фазы когерентной несущей (ЦВФКН) на основании методов цифровой фильтрации.
Дискретный сигнал может быть получен из исходного аналогового сигнала [4, стр.512] с использованием фильтрующего свойства дельта-функции . В этом случае его можно представить в виде свертки дельта-функции с весовыми коэффициентами, которые равны отсчетам  от исходного аналогового сигнала  в точках 

 ,                           (1)

где ,  - период дискретизации. Так как реальный входной сигнал в силу причинно-следственных связей отсчитывается от конкретного значения времени , которое можно приравнять нулю, то (1) можно записать в виде ( с учетом нормировки во времени) в виде 

 ,                              (2)

Пусть входной аналоговый сигнал на входе усилителя высокой частоты (УВЧ) приемника (синфазный сигнал) описывается как 

 ,                             (3)

где  - амплитуда входного сигнала, - несущая частота входного сигнала, - фаза принятого сигнала,  - время. Тогда входной сигнал (3) в дискретной форме в соответствии с (2) примет вид 

 .                           (4)

Как известно [5, стр. 365], для (3) сопряженный по Гильберту сигнал (квадратурный сигнал) будет иметь вид

.                             (5)

В этом случае дискретная форма сигнала (5) будет иметь вид

 .                           (6)

Учитывая (4) и (6) можно записать дискретный входной сигнал в комплексной форме как

.                    (7)

Так как входной сигнал (4) есть функция действительной переменной, то достаточно восстановить фазу действительной или мнимой части комплексного сигнала (7) для обеспечения дальнейшего синхронного детектирования. 
Функциональная схема восстановления фазы действительной части когерентной несущей [1, стр. 36] для аналогового сигнала приведена на рисунке 1.



Функциональная схема блока ВФКН для узкополосного сигнала с гармонической несущей, приведенной в [3], в которой для выделения значения фазовой ошибки  используется дополнительные функциональные блоки: фильтры нижних частот (ФНЧ), ограничитель уровня амплитуды, фазовращатели на , которые обеспечивают получение сигнала сопряженного по Гильберту так, как для узкополосных сигналов с гармонической несущей это преобразование сводится к сдвигу фазы на  . 
Однако, прямая реализация этих схем в цифровой форме невозможна по понятным причинам. Передаточная функция фазового фильтра для ВФКН определяется выражением [1, стр. 35]

,                             (8)

где  коэффициент усиления, который для простоты выкладок можно приравнять единице. Используя фильтрующее свойство дельта-функции (2), не сложно показать, что (8) в дискретной форме примет вид

,                                  (9)

где функция определена для  и равна нулю для остальных . Определим z-преобразование [4, стр.545] от (9)

                            (10)

и запишем классическое уравнение связи [4, стр.546] между z-преобразованием передаточной функции (системной функции) и импульсной функцией дискретного фильтра

,                             (11)

где G(z) - передаточная функция дискретного фильтра, Y(z) - z-преобразование от выходного сигнала, X(z) - z-преобразование от входного сигнала, - импульсная характеристика дискретного фильтра. Сравнивая (10) и (11) легко заметить, что коэффициенты  есть не что иное, как коэффициенты импульсной характеристики дискретного фильтра, что соответствует коэффициентам не рекурсивного дискретного фильтра с конечной импульсной характеристикой (КИХ фильтра). Длина такого фильтра является бесконечной. Реализовать такой фильтр практически не возможно. Поэтому необходимо произвести выбор конечной длины фильтра, которая равна N, но, из-за отсутствия априорной информации о значениях фазы , прямая реализация такого КИХ фильтра становится невозможной. 
Однако, если сигналы имеют конечный период повторения (например, сигнал на входе приемника импульсной радиолокационной станции), то можно определить для каждого дискретного отсчета коэффициент импульсной функции и обеспечить формирование структуры цифрового фильтра длиной N, так как принятый сигнал находится в памяти и есть время на обработку и вычисления. Но проще воспользоваться дискретной функцией передачи.
Исходя из свойства линейности и стационарности, из теории дискретных систем известно[6, стр.189], что для дискретной функции (7) в точках дискретизации выполняются все алгебраические преобразования, что и для аналогового сигнала. И, следовательно, можно записать произведение для (7) и (9), которое будет соответствовать выходному дискретному сигналу с восстановленной (“цифровой”) когерентной несущей. Тогда дискретный сигнал на выходе комплексного цифрового перемножителя для каждого дискретного значения n будет определяться как

             (12)


Или


.             (13)

Следовательно, мнимая часть (13) есть дискретный входной сигнал, но с полностью компенсированной случайной фазой . Действительная часть (13) является квадратурной составляющей также с скомпенсированной фазой, которую можно использовать в квадратурных демодуляторах сигналов. Эти составляющие имеет следующий вид

,   (14)
или
.   (15)

С учетом (4), (6) и (15) функциональная схема блока ВФКН, приведенная в [1, стр. 38], может быть преобразована к виду, который приведен на рис.2. В состав ЦВФКН входят следующие блоки: АЦП - аналого-цифровой преобразователь, ЦДОА - цифровой двухсторонний ограничитель амплитуды, ЦФГ - цифровой фильтр Гильберта, ЦФНЧ - цифровой фильтр нижних частот, КГС - квадратурный генератор сигналов, который вырабатывает тактовые импульсы для синхронизации всего устройства, косинусную и синусную составляющие с частотой .


Рис. 2 Функциональная схема блока цифрового восстановления фазы когерентной несущей (ЦВФКН). q- амплитуда сигналов ошибки, которая является положительной константой.

Результат имитационного моделирования работы блока ЦВФКН приведен на рисунке 3. На этом рисунке приведены тридцать два отсчета синусоидального сигнала с частотой 10 кГц (верхняя эпюра) с восьмикратной передискретизацией частоты (160 кГц) для лучшей наглядности сдвига фазы. На средней эпюре приведена такая же синусоида, что и на верней эпюре, но со сдвигом фазы по закону 

.                              (16)

где - частота дрейфа фазы (в данном примере 1 кГц). Такой закон дрейфа фазы выбран потому, что он характерен для замираний при прохождении сигнала в атмосфере [7, стр. 199]. 


Рис. 3 Эпюры 32 отсчетов цифрового сигнала когерентной несущей с частотой: 10 кГц (верхняя эпюра), та же несущая частота с дрейфом фазы по косинусному закону и частотой 1 кГц (средняя эпюра); восстановленная цифровая когерентная несущая 10 кГц (нижняя эпюра).

На нижней эпюре приведен результат цифровой фильтрации блоком ЦВФКН в соответствии со схемой, приведенной на рисунке 2, где  интервал дискретизации,   - частота дискретизации (в данном примере 160 кГц). На рисунке 4 приведена функциональная схема цифрового ограничителя сигнала, который обеспечивает постоянную положительную амплитуду сигнал, но сохраняет фазовую ошибку входного сигнала.


Рис.4 Функциональная схема цифрового двухстороннего ограничителя амплитуды (ЦДОА)

В его состав входят два цифровых перемножителя и дополнительные блоки: ЦДОА - цифровой двухсторонний ограничитель амплитуды, ЦПФ - цифровой полосовой фильтр,  - усилителя напряжения (в реальной схеме совмещен со вторым умножителем).
На рисунке 5 приведена функциональная схема ЦВФКН, которая может быть использована в дальнейшем для построения цифровых демодуляторов с обычной амплитудной модуляцией (АМ), балансной АМ, однополосной АМ, частотной модуляцией, фазовой модуляцией и квадратурной модуляцией (или соответствующими манипуляциями Все цифровые фильтры ФНЧ на этой схеме выбраны третьего порядка так, как несущая частота (или промежуточная частота) обычно на несколько порядков больше чем верхняя частота в спектре сигнала. В этом случае эти фильтры обеспечат достаточно затухание (60 дБ на декаду) для внеполосных частот, что вполне достаточно для фильтрации низкочастотных составляющих. При необходимости порядок фильтров может быть увеличен (или уменьшен). Входной сигнал  поступает на вход к которому подключены входы цифрового фильтра Гильберта (ЦФГ) и цифрового двухстороннего ограничителя амплитуды (ЦДОА). 
Цифровой фильтр Гильберта выполнен в данной схеме как симметричный КИХ фильтр седьмого порядка нечетного типа с положительной симметрией (фильтр второго типа). Фильтры такого типа могут принимать любые значения АЧХ на всех рабочих частотах, что полностью соответствует требованиям к АЧХ для фильтров Гильберта. Рекомендуемые во многих источниках фильтры третьего типа [5, стр. 361] могут принимать любые значения на всех частотах кроме граничной частоты (частота Найквиста). Но эти фильтры имеют несимметричные коэффициенты и, как следствие, для их реализации нужно в два раза больше умножителей, чем для фильтров с положительной симметрией. Задержка, вносимая симметричными фильтрами с нечетным порядком, равна (N-1)/2 периодов дискретизации. В данном случае она равна трем.
Цифровой двухсторонний ограничитель амплитуды состоит из первого перемножителя, на который поступает входной сигнал и синусный сигнал квадратурного генератора. Выход же первого умножителя блока ЦДОА подключен ко входу цифрового фильтра нижних частот третьего порядка. Выход этого фильтра подключен к входу второго перемножителя, на второй вход которого поступает синусный сигнал квадратурного генератора, который задержан цифровой линией задержки на три периода дискретизации. Это необходимо для компенсации групповой задержки, которую вносит цифровой фильтр нижних частот в ЦДОА. На выходе этого цифрового фильтра формируется низкочастотная составляющая, которая перемножается с входным сигналом. Так как перемножаемые сигналы имеют одинаковый знак амплитуды, то знак результата перемножения этих сигналов будет всегда положительным. Результат перемножения поступает на вход усилителя (перемножителя на константу) , который усиливает амплитуду сигнала до величины необходимой для работы цифрового компаратора. Если выбрать константу кратную степени двойки, то операцию умножения можно заменить на операцию сдвига на необходимое число двоичных разрядов. Цифровой компаратор ограничивает значение модуля амплитуды сигнала на уровне заданного значения . С выхода цифрового компаратора, сигнал, ограниченный по амплитуде, поступит на вход цифрового ФНЧ, на выходе которого будет сигнал вида . ЦДОА вносит групповую задержку, равную шести периодам дискретизации так, как сигнал проходит два ФНЧ третьего порядка каждый. Так образом, с выхода ЦФГ, создающего групповую задержку три периода дискретизации, синфазный и квадратурный сигналы должны быть задержаны еще на три периода дискретизации для устранения смещения во времени относительно выхода ЦДОА. С выходов ЦДОА ограниченный по амплитуде сигнал поступает на формирователи сигналов ошибки, состоящие из перемножителей и ФНЧ третьего порядка. На вторые входы этих перемножителей поступают сигналы синуса и косинуса от КГС через цифровые линии задержки, которые обеспечивают выравнивание во времени сигналов синуса и косинуса с ограниченным ЦДОА сигналом. С выходов формирователей сигналы ошибки поступают на соответствующие перемножители узла сумматора, где они перемножаются с синфазным и квадратурным сигналами и результаты перемножения суммируются, что обеспечивает формирование сигнала (15) с скомпенсированной фазовой ошибкой. 



Синхронный детектор АМ сигналов состоит из перемножителя и ФНЧ (классическая схема). На вход этого детектора поступает сигнал  с выхода сумматора ЦВФКН. Так как стабильность частоты обеспечивается кварцевым квадратурным генератором (или синтезатором), то проблем при демодуляции всех видов АМ сигнала из-за стабильности частоты не возникает (что имеет место при АМ модуляции без несущей (балансной модуляции) и при однополосной АМ модуляции (ОБП АМ) с классическими блоками фазовой автоподстройки. Высокая стабильность квадратурного кварцевого генератора обеспечивает также возможность демодуляции сигналов с различными видами частотной, фазовой или квадратурной модуляции (манипуляций) с высокой степенью когерентности несущей и частоты опорного генератора, роль которого выполняет квадратурный цифровой генератор (КГС). В этом случае вместо синхронного детектора АМ сигналов должен быть подключен к выходу ЦВФКН соответствующий цифровой синхронный детектор.
Полученные результаты подтверждаются результатами имитационного моделирования работы синхронного детектора с ЦВФКН и цифровым ограничителем уровня c использованием процессора 32 разрядного универсального микропроцессора Pentium (с тактовой частотой 3 ГГц). Результаты моделирования позволяют утверждать, что можно использовать данный алгоритм практически для любого вида цифрового вычислителя в виде схемной (FPGA или DSP) или программной реализации. Данная схема ЦВФКН может использоваться в радиотехнике, оптоволоконных или кабельных линия передачи, спутниковой связи, радиоастрономии, радионавигации, радиофизике, системах автоматики, измерительных устройствах и других приложениях имеющих ФАПЧ, АПЧ или синхронный детектор. Сигнал тактовых импульсов (Ти) позволяет принимать демодулированный сигнал синхронно по фронтам этих импульсов, что позволяет обеспечить полностью синхронную передачу сигналов через канал передачи данных по аналогии с оптоволоконными линиями связи, то есть, построить синхронную иерархию передачи данных через радиоканал передачи данных, спутниковый канал передачи данных или по медным кабелям связи.


Литература

1). Коханов А.Б. Восстановление фазы когерентной несущей частоты при синхронном детектировании / А.Б. Коханов // Радиоэлектроника. - 2012. - Т. 55, № 2. - С. 34. - (Известия вузов). - ISSN 0021-3470.
). Коханов А.Б. Технология синхронного детектирования сигналов / А.Б. Коханов // Радиоэлектроника. - 2007. - Т. 50, № 11. - С. 14-25. - (Известия вузов). - ISSN 0021-3470.
). Пат. Украины UA № 22274 U, МПК H03D99/00. Демодулятор сигналов с амплитудно-фазовой модуляцией / А.Б. Коханов ; заяв. 18.09.2006 ; опубл. 25.04.2007 ; бюл. № 5.
). Основы теории цепей : Учебник для вузов / В.П. Бокалов, В.Ф. Дмитриков, Б.И. Крук ; под ред. В.П. Бакалова.-3-е изд. прераб. и доп. -- М.: Горячая линия-Телеком, 2009.   -596с.: ил.
). Ричард Лайонс. Цифровая обработка сигналов: Второе издание. Пер. с англ.. - М.: ООО "Бином-Пресс", 2011. - 656 с.: ил.
). Цифровая обработка сигналов/ А.Б. Сергиенко-СПб.: Питер, 2003. - 604 с.: ил.
). Радиорелейные и спутниковые системы передачи: Учеб. Для вузов/ А.С. Немировский, О.С. Данилович, Ю.И. Маримот и др. Под ред. А.С. Немировского.: Радио и связь, 1986. - 392 с. : ил.